<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Business Card Scanner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-shell">
        <!-- Status Dots -->
        <div class="status-row">
            <span class="status-dot green"></span>
            <span class="status-dot blue"></span>
            <span class="status-dot orange"></span>
        </div>

        <!-- Homepage -->
        <section id="homepage-actions" class="screen active">
            <header>
                <div class="logo-wrapper">
                    <div class="logo-camera">
                        <div class="camera-lens"></div>
                    </div>
                </div>
                <h1>Business Card Scanner</h1>
                <p>AI-powered OCR for contact management</p>
            </header>

            <main>
                <button class="action-card" id="scan-card-btn">
                    <span class="icon-pill scan">
                        <span class="icon-shape"></span>
                        <span class="icon-dot-small"></span>
                    </span>
                    <div class="card-text">
                        <h2>Scan Business Card</h2>
                        <p>Capture and extract details</p>
                    </div>
                    <span class="chevron">‚Ä∫</span>
                </button>

                <button class="action-card" id="view-contacts-btn">
                    <span class="icon-pill browse">
                        <span class="icon-lines"></span>
                        <span class="icon-dot-small blue"></span>
                    </span>
                    <div class="card-text">
                        <h2>Browse Contacts</h2>
                        <p>View saved cards</p>
                    </div>
                    <span class="chevron">‚Ä∫</span>
                </button>

                <button class="action-card" id="login-btn">
                    <span class="icon-pill login">
                        <span class="icon-note"></span>
                        <span class="icon-dot-small red"></span>
                    </span>
                    <div class="card-text">
                        <h2>Login / Register</h2>
                        <p>Access your account</p>
                    </div>
                    <span class="chevron">‚Ä∫</span>
                </button>
            </main>

            <footer>
                <div class="total-row">
                    <span>Total Cards:</span>
                    <span id="total-cards-count">0</span>
                </div>
                <div class="progress">
                    <div class="segment-red"></div>
                    <div class="segment-yellow"></div>
                    <div class="segment-blue"></div>
                </div>
            </footer>
        </section>

        <!-- Camera Section -->
        <section id="camera-section" class="screen hidden">
            <header>
                <h1>Scan Card</h1>
                <p>Position the card within the frame</p>
            </header>
            <div class="camera-container">
                <video id="video" autoplay playsinline muted></video>
                <canvas id="canvas" style="display: none;"></canvas>
                <canvas id="detection-canvas" style="display: none;"></canvas>
                <div id="camera-overlay" class="camera-overlay">
                    <div class="scan-frame"></div>
                    <p class="instruction">Position card within frame</p>
                </div>
                <div id="camera-placeholder" class="camera-placeholder">
                    <p>üì∑ Camera not available</p>
                    <p class="placeholder-hint">Use file upload instead</p>
                </div>
            </div>
            <div class="controls">
                <button id="capture-btn" class="btn btn-primary" disabled>
                    üì∑ Capture Card
                </button>
                <button id="upload-btn" class="btn btn-secondary">
                    üìÅ Upload Image
                </button>
                <input type="file" id="file-input" accept="image/*" capture="environment" style="display: none;">
            </div>
        </section>

        <!-- Processing Section -->
        <section id="processing-section" class="screen hidden">
            <div class="spinner-container">
                <div class="spinner"></div>
                <p>Processing card...</p>
                <p class="processing-status">Extracting information...</p>
            </div>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="screen hidden">
            <header>
                <h1>Extracted Information</h1>
                <div class="confidence-badge" id="confidence-badge">
                    <span id="confidence-value">--</span>% confidence
                </div>
            </header>

            <!-- Captured Card Image Preview -->
            <div class="card-image-preview">
                <h3>Captured Card</h3>
                <div class="card-image-container">
                    <img id="captured-card-image" src="" alt="Captured visiting card" class="card-image">
                </div>
            </div>

            <div class="results-container">
                <div class="field-group">
                    <label for="name">Name *</label>
                    <input type="text" id="name" class="field-input" placeholder="Name">
                    <span class="field-confidence" id="name-confidence"></span>
                </div>

                <div class="field-group">
                    <label for="organisation">Organisation</label>
                    <input type="text" id="organisation" class="field-input" placeholder="Company/Organisation">
                    <span class="field-confidence" id="organisation-confidence"></span>
                </div>

                <div class="field-group">
                    <label for="mobile">Mobile Number</label>
                    <input type="tel" id="mobile" class="field-input" placeholder="+91 12345 67890">
                    <span class="field-confidence" id="mobile-confidence"></span>
                </div>

                <div class="field-group">
                    <label for="landline">Landline Number</label>
                    <input type="tel" id="landline" class="field-input" placeholder="044-1234 5678">
                    <span class="field-confidence" id="landline-confidence"></span>
                </div>

                <div class="field-group">
                    <label for="email">Email ID</label>
                    <input type="email" id="email" class="field-input" placeholder="email@example.com">
                    <span class="field-confidence" id="email-confidence"></span>
                </div>

                <div class="field-group">
                    <label for="designation">Designation</label>
                    <input type="text" id="designation" class="field-input" placeholder="Job Title">
                    <span class="field-confidence" id="designation-confidence"></span>
                </div>
            </div>

            <div class="actions">
                <button id="save-btn" class="btn btn-success">
                    üíæ Save Contact
                </button>
                <button id="retry-btn" class="btn btn-secondary">
                    üîÑ Scan Another
                </button>
            </div>

            <!-- Debug Section (Collapsible) -->
            <details class="raw-text-section">
                <summary>üîç Debug: View OCR & Extraction Details</summary>
                <div class="debug-section">
                    <h3>Raw OCR Text:</h3>
                    <pre id="raw-text" class="raw-text"></pre>
                    <h3>Extracted Text (Parser Output):</h3>
                    <pre id="extracted-text" class="raw-text"></pre>
                    <h3>Extraction Method:</h3>
                    <p id="extraction-method" class="method-info"></p>
                </div>
            </details>
        </section>

        <!-- Contacts List Section -->
        <section id="contacts-section" class="screen hidden">
            <header>
                <h1>Saved Contacts</h1>
                <button id="close-contacts-btn" class="btn btn-secondary btn-small">
                    ‚úï Close
                </button>
            </header>
            <div class="search-container">
                <input type="text" id="contacts-search" class="search-input" placeholder="üîç Search contacts by name, email, organisation...">
            </div>
            <div id="contacts-list" class="contacts-list">
                <p>Loading contacts...</p>
            </div>
        </section>

        <!-- Login/Register Section -->
        <section id="auth-section" class="screen hidden">
            <header>
                <h1>Login / Register</h1>
            </header>
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="register">Register</button>
            </div>
            
            <div id="login-form" class="auth-form active">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <div class="input-wrapper">
                        <span class="input-icon">‚úâÔ∏è</span>
                        <input type="email" id="login-email" class="form-input" placeholder="your@email.com">
                    </div>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üîí</span>
                        <input type="password" id="login-password" class="form-input" placeholder="Enter your password">
                    </div>
                </div>
                <div class="form-footer">
                    <a href="#" class="forgot-password">Forgot password?</a>
                </div>
                <button id="login-submit-btn" class="btn btn-primary btn-block">Login</button>
                <p class="auth-switch">Don't have an account? <a href="#" id="switch-to-register">Register</a></p>
            </div>
            
            <div id="register-form" class="auth-form">
                <div class="form-group">
                    <label for="register-name">Name</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üë§</span>
                        <input type="text" id="register-name" class="form-input" placeholder="Your name">
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <div class="input-wrapper">
                        <span class="input-icon">‚úâÔ∏è</span>
                        <input type="email" id="register-email" class="form-input" placeholder="your@email.com">
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-password">Password</label>
                    <div class="input-wrapper">
                        <span class="input-icon">üîí</span>
                        <input type="password" id="register-password" class="form-input" placeholder="Create a password">
                    </div>
                </div>
                <button id="register-submit-btn" class="btn btn-primary btn-block">Register</button>
                <p class="auth-switch">Already have an account? <a href="#" id="switch-to-login">Login</a></p>
            </div>
        </section>

        <!-- Duplicate Warning Modal -->
        <div id="duplicate-modal" class="modal hidden">
            <div class="modal-content">
                <h3>‚ö†Ô∏è Duplicate Contact Detected</h3>
                <div id="duplicate-info" class="duplicate-info"></div>
                <div class="modal-actions">
                    <button id="overwrite-btn" class="btn btn-warning">üîÑ Overwrite Existing</button>
                    <button id="save-new-btn" class="btn btn-success">üíæ Save as New</button>
                    <button id="cancel-save-btn" class="btn btn-secondary">‚ùå Cancel</button>
                </div>
            </div>
        </div>

        <!-- Success Message -->
        <div id="success-message" class="message success hidden">
            ‚úÖ Contact saved successfully!
        </div>

        <!-- Error Message -->
        <div id="error-message" class="message error hidden">
            ‚ùå <span id="error-text"></span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
